(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{338:function(s,t,a){s.exports=a.p+"assets/img/scope-two.7e0f7bc3.png"},449:function(s,t,a){s.exports=a.p+"assets/img/scope-one.f9f67f2f.png"},450:function(s,t,a){s.exports=a.p+"assets/img/scope-four.d4f99640.png"},505:function(s,t,a){"use strict";a.r(t);var n=a(27),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"作用域-scope"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#作用域-scope"}},[s._v("#")]),s._v(" 作用域（"),n("code",[s._v("scope")]),s._v("）")]),s._v(" "),n("p",[n("strong",[s._v("作用域")]),s._v("是指在程序中定义变量的区域，该位置决定了变量的生命周期。通俗地理解，作用域就是变量与函数的可访问范围，即作用域控制着变量和函数的可见性和生命周期。")]),s._v(" "),n("p",[s._v("在 "),n("code",[s._v("ES6")]),s._v(" 之前，"),n("code",[s._v("ES")]),s._v(" 的作用域只有两种：")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("全局作用域")]),s._v(",代码中的任何地方都能访问，其生命周期伴随着页面的生命周期")]),s._v(" "),n("li",[n("strong",[s._v("函数作用域")]),s._v(",函数内部定义的变量或者函数，并且定义的变量或者函数只能在函数内部被访问。函数执行结束之后，函数内部定义的变量会被销毁")])]),s._v(" "),n("p",[s._v("由于"),n("code",[s._v("JavaScript")]),s._v(" 的变量提升存在着变量覆盖、变量污染等设计缺陷，所以"),n("code",[s._v("ES6")]),s._v("引入了"),n("code",[s._v("let")]),s._v(" 和 "),n("code",[s._v("const")]),s._v("关键字,从而使 "),n("code",[s._v("JavaScript")]),s._v(" 拥有了"),n("strong",[s._v("块级作用域")])]),s._v(" "),n("h2",{attrs:{id:"javascript-是如何支持块级作用域的"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#javascript-是如何支持块级作用域的"}},[s._v("#")]),s._v(" "),n("code",[s._v("JavaScript")]),s._v(" 是如何支持块级作用域的")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" a "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" b "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" b "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" d "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("d"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h3",{attrs:{id:"_1-编译并创建执行上下文"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-编译并创建执行上下文"}},[s._v("#")]),s._v(" 1. 编译并创建执行上下文")]),s._v(" "),n("p",[n("img",{attrs:{src:a(449),alt:"scope-one"}})]),s._v(" "),n("ul",[n("li",[s._v("函数内部通过"),n("code",[s._v("var")]),s._v(" 声明的变量，在编译阶段全都被存放到变量环境里面了。")]),s._v(" "),n("li",[s._v("通过 "),n("code",[s._v("let")]),s._v("声明的变量，在编译阶段会被存放到词法环境（"),n("code",[s._v("Lexical Environment")]),s._v("）中。")]),s._v(" "),n("li",[s._v("函数里面的块作用域，即通过"),n("code",[s._v("let")]),s._v(" 声明的变量并没有被存放到词法环境中。")]),s._v(" "),n("li",[n("h3",{attrs:{id:"_2-执行代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-执行代码"}},[s._v("#")]),s._v(" 2. 执行代码")])])]),s._v(" "),n("p",[n("img",{attrs:{src:a(338),alt:"scope-one"}})]),s._v(" "),n("p",[s._v("在词法环境内部，维护了一个小型栈结构，栈底是函数最外层的变量，进入一个作用域块后，就会把该作用域块内部的变量压到栈顶；当作用域执行完成之后，该作用域的信息就会从栈顶弹出，这就是词法环境的结构")]),s._v(" "),n("p",[s._v("当执行到作用域块中的"),n("code",[s._v("console.log(a)")]),s._v("这行代码时，会沿着词法环境的栈顶向下查询，如果在词法环境中的某个块中查找到了，就直接返回给 "),n("code",[s._v("JavaScript")]),s._v("引擎，如果没有查找到，那么继续在变量环境中查找。")]),s._v(" "),n("p",[n("img",{attrs:{src:a(338),alt:"scope-three"}})]),s._v(" "),n("p",[s._v("当作用域块执行结束之后，其内部定义的变量就会从词法环境的栈顶弹出")]),s._v(" "),n("p",[n("img",{attrs:{src:a(450),alt:"scope-four"}})]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("块级作用域")]),s._v("是通过"),n("strong",[s._v("词法环境")]),s._v("的栈结构来实现")]),s._v(" "),n("li",[n("strong",[s._v("变量提升")]),s._v("是通过"),n("strong",[s._v("变量环境")]),s._v("来实现")])]),s._v(" "),n("p",[s._v("通过这两者的结合，"),n("code",[s._v("JavaScript")]),s._v(" 引擎也就同时支持了"),n("strong",[s._v("变量提升")]),s._v("和"),n("strong",[s._v("块级作用域")]),s._v("了。")])])}),[],!1,null,null,null);t.default=e.exports}}]);