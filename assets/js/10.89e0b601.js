(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{403:function(v,_,o){v.exports=o.p+"assets/img/IP.00d9bcad.png"},404:function(v,_,o){v.exports=o.p+"assets/img/UDP.3edb673a.png"},405:function(v,_,o){v.exports=o.p+"assets/img/TCP.943ac29f.png"},406:function(v,_,o){v.exports=o.p+"assets/img/full-TCP.440ee50d.png"},473:function(v,_,o){"use strict";o.r(_);var e=o(27),t=Object(e.a)({},(function(){var v=this,_=v.$createElement,e=v._self._c||_;return e("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[e("p",[v._v("在衡量"),e("code",[v._v("Web")]),v._v(" 页面性能的时候有一个重要的指标叫"),e("code",[v._v("FP（First Paint）")]),v._v("，是指"),e("strong",[v._v("从页面加载到首次开始绘制的时长")]),v._v("。那什么影响 "),e("code",[v._v("FP")]),v._v("指标呢？其中一个重要的因素是"),e("strong",[v._v("网络加载速度")]),v._v("。")]),v._v(" "),e("ul",[e("li",[v._v("优化"),e("code",[v._v("Web")]),v._v("页面的加载速度，需要对网络有充分的了解")]),v._v(" "),e("li",[v._v("理解网络的关键是要对网络协议有深刻的认识")]),v._v(" "),e("li",[v._v("不管是"),e("code",[v._v("HTTP")]),v._v("，还是 "),e("code",[v._v("WebSocket")]),v._v("，都是基于 "),e("code",[v._v("TCP/IP")]),v._v(" 的")])]),v._v(" "),e("h2",{attrs:{id:"数据包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据包"}},[v._v("#")]),v._v(" 数据包")]),v._v(" "),e("p",[v._v("互联网中的数据是通过数据包来传输的,如果发送的数据很大,该数据就会被拆分为很多小数据包来传输")]),v._v(" "),e("h3",{attrs:{id:"ip-把数据包送达目的主机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ip-把数据包送达目的主机"}},[v._v("#")]),v._v(" IP: 把数据包送达目的主机")]),v._v(" "),e("p",[v._v("数据包要在互联网上进行传输，就要符合网际协议（"),e("code",[v._v("Internet Protocol")]),v._v("，简称"),e("code",[v._v("IP")]),v._v("）标准\n计算机的地址就称为"),e("code",[v._v("IP")]),v._v(" 地址，访问任何网站实际上只是你的计算机向另外一台计算机请求信息。")]),v._v(" "),e("blockquote",[e("p",[v._v("就像寄件,填上收件人地址,就可以往这个地址发包裹,京东就可以把物品送到目的地")])]),v._v(" "),e("p",[v._v("一个数据包从主机"),e("code",[v._v("A")]),v._v("发送给主机"),e("code",[v._v("B")]),v._v("，在传输之前，数据包上会被附加上主机"),e("code",[v._v("B")]),v._v("的"),e("code",[v._v("IP")]),v._v(" 地址信息，这样在传输过程中才能正确寻址。额外地，数据包上还会附加上主机"),e("code",[v._v("A")]),v._v(" 本身的 "),e("code",[v._v("IP")]),v._v(" 地址，有了这些信息主机 "),e("code",[v._v("B")]),v._v("才可以回复信息给主机"),e("code",[v._v("A")]),v._v("。这些附加的信息会被装进一个叫 "),e("code",[v._v("IP")]),v._v(" 头的数据结构里。"),e("code",[v._v("IP")]),v._v("头是 "),e("code",[v._v("IP")]),v._v("数据包开头的信息，包含 "),e("code",[v._v("IP")]),v._v(" 版本、源 "),e("code",[v._v("IP")]),v._v("地址、目标 "),e("code",[v._v("IP")]),v._v(" 地址、生存时间等信息。\n为了方便理解，我先把网络简单分为三层结构，如下图：\n"),e("img",{attrs:{src:o(403),alt:"IP"}})]),v._v(" "),e("h2",{attrs:{id:"udp-把数据包送达应用程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#udp-把数据包送达应用程序"}},[v._v("#")]),v._v(" UDP: 把数据包送达应用程序")]),v._v(" "),e("p",[e("code",[v._v("IP")]),v._v(" 是非常底层的协议，只负责把数据包传送到对方电脑，但是对方电脑并不知道把数据包交给哪个程序，是交给浏览器还是交给王者荣耀？因此，需要基于"),e("code",[v._v("IP")]),v._v(" 之上开发能和应用打交道的协议，最常见的是"),e("strong",[v._v("用户数据包协议")]),v._v("（"),e("code",[v._v("User Datagram Protocol")]),v._v("）”，简称"),e("code",[v._v("UDP")]),v._v("。")]),v._v(" "),e("p",[e("code",[v._v("UDP")]),v._v(" 中一个最重要的信息是端口号，端口号其实就是一个数字，每个想访问网络的程序都需要绑定一个端口号。通过端口号 "),e("code",[v._v("UDP")]),v._v(" 就能把指定的数据包发送给指定的程序了")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("IP")]),v._v(" 通过"),e("code",[v._v("IP")]),v._v("地址信息把数据包发送给指定的电脑")]),v._v(" "),e("li",[e("code",[v._v("UDP")]),v._v("通过端口号把数据包分发给正确的程序")]),v._v(" "),e("li",[v._v("和 "),e("code",[v._v("IP")]),v._v(" 头一样，端口号会被装进"),e("code",[v._v("UDP")]),v._v(" 头里面，"),e("code",[v._v("UDP")]),v._v("头再和原始数据包合并组成新的"),e("code",[v._v("UDP")]),v._v("数据包。"),e("code",[v._v("UDP")]),v._v("头中除了目的端口，还有源端口号等信息。")])]),v._v(" "),e("p",[v._v("为了支持"),e("code",[v._v("UDP")]),v._v(" 协议，把前面的三层结构扩充为四层结构，在网络层和上层之间增加了传输层，如下图所示：")]),v._v(" "),e("p",[e("img",{attrs:{src:o(404),alt:"UDP"}})]),v._v(" "),e("p",[v._v("在使用 "),e("code",[v._v("UDP")]),v._v("发送数据时，有各种因素会导致数据包出错，虽然 "),e("code",[v._v("UDP")]),v._v("可以校验数据是否正确，但是对于错误的数据包，"),e("code",[v._v("UDP")]),v._v("并不提供重发机制，只是丢弃当前的包，而且 "),e("code",[v._v("UDP")]),v._v("在发送之后也无法知道是否能达到目的地。")]),v._v(" "),e("p",[v._v("虽说"),e("code",[v._v("UDP")]),v._v("不能保证数据可靠性，但是传输速度却非常快，所以 "),e("code",[v._v("UDP")]),v._v(" 会应用在一些关注速度、但不那么严格要求数据完整性的领域，如在线视频、互动游戏等。")]),v._v(" "),e("h3",{attrs:{id:"tcp-把数据完整地送达应用程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tcp-把数据完整地送达应用程序"}},[v._v("#")]),v._v(" TCP：把数据完整地送达应用程序")]),v._v(" "),e("p",[v._v("对于浏览器请求，或者邮件这类要求数据传输可靠性（"),e("code",[v._v("reliability")]),v._v("）的应用，如果使用 UDP 来传输会存在两个问题：")]),v._v(" "),e("ul",[e("li",[v._v("数据包在传输过程中容易丢失")]),v._v(" "),e("li",[v._v("大文件会被拆分成很多小的数据包来传输，这些小的数据包会经过不同的路由，并在不同的时间到达接收端，而 "),e("code",[v._v("UDP")]),v._v("协议并不知道如何组装这些数据包，从而把这些数据包还原成完整的文件。")])]),v._v(" "),e("p",[e("code",[v._v("TCP")]),v._v("（"),e("code",[v._v("Transmission Control Protocol")]),v._v("，传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议。相对于"),e("code",[v._v("UDP")]),v._v("，有下面两个特点:")]),v._v(" "),e("ul",[e("li",[v._v("对于数据包丢失的情况，提供重传机制；")]),v._v(" "),e("li",[v._v("引入了数据包排序机制，用来保证把乱序的数据包组合成一个完整的文件。")])]),v._v(" "),e("p",[v._v("和 "),e("code",[v._v("UDP")]),v._v("头一样，"),e("code",[v._v("TCP")]),v._v(" 头除了包含了目标端口和本机端口号外，还提供了用于排序的序列号，以便接收端通过序号来重排数据包。\nTCP 下的单个数据包的传输流程：\n"),e("img",{attrs:{src:o(405),alt:"TCP"}})]),v._v(" "),e("p",[v._v("从下图可以看出，一个完整的 TCP 连接的生命周期包括了"),e("code",[v._v("建立连接-传输数据-断开连接")]),v._v("三个阶段。\n"),e("img",{attrs:{src:o(406),alt:"full-TCP"}})]),v._v(" "),e("ol",[e("li",[e("strong",[v._v("建立连接")]),v._v(" 这个阶段是通过"),e("strong",[v._v("三次握手")]),v._v("来建立客户端和服务器之间的连接。 "),e("code",[v._v("TCP")]),v._v(" 提供面向连接的通信传输。面向连接是指在数据通信开始之前先做好两端之间的准备工作。所谓三次握手，是指在建立一个 "),e("code",[v._v("TCP")]),v._v("连接时，客户端和服务器总共要发送三个数据包以确认连接的建立。")]),v._v(" "),e("li",[e("strong",[v._v("传输数据")]),v._v(" 在该阶段，接收端需要对每个数据包进行确认操作，也就是接收端在接收到数据包之后，需要发送确认数据包给发送端。所以当发送端发送了一个数据包之后，在规定时间内没有接收到接收端反馈的确认消息，则判断为数据包丢失，并触发发送端的重发机制。同样，一个大的文件在传输过程中会被拆分成很多小的数据包，这些数据包到达接收端后，接收端会按照 TCP 头中的序号为其排序，从而保证组成完整的数据。")]),v._v(" "),e("li",[e("strong",[v._v("断开连接")]),v._v(" 数据传输完毕之后，就要终止连接了，涉及到最后一个阶段"),e("strong",[v._v("四次挥手")]),v._v("来保证双方都能断开连接。")])]),v._v(" "),e("p",[e("code",[v._v("TCP")]),v._v("为了保证数据传输的可靠性，牺牲了数据包的传输速度，因为"),e("strong",[v._v("三次握手")]),v._v("和"),e("strong",[v._v("数据包校验机制")]),v._v("等把传输过程中的数据包的数量提高了一倍。")])])}),[],!1,null,null,null);_.default=t.exports}}]);