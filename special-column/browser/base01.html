<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chrome架构 | 草莓牛奶</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/docs/strawberry.png">
    <meta name="description" content="一个笔记本">
    <meta name="author" content="草莓牛奶">
    <meta name="Keywords" content="vuepress 介绍, vuepress 说明, 草莓牛奶">
    
    <link rel="preload" href="/docs/assets/css/0.styles.6b8e1be2.css" as="style"><link rel="preload" href="/docs/assets/js/app.f83263f5.js" as="script"><link rel="preload" href="/docs/assets/js/2.61df76d7.js" as="script"><link rel="preload" href="/docs/assets/js/8.98e910b4.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e017752f.js"><link rel="prefetch" href="/docs/assets/js/11.14948b35.js"><link rel="prefetch" href="/docs/assets/js/12.13209217.js"><link rel="prefetch" href="/docs/assets/js/13.f60acfdb.js"><link rel="prefetch" href="/docs/assets/js/14.f4003c8d.js"><link rel="prefetch" href="/docs/assets/js/15.ee20c976.js"><link rel="prefetch" href="/docs/assets/js/16.98308acb.js"><link rel="prefetch" href="/docs/assets/js/17.96c70e4f.js"><link rel="prefetch" href="/docs/assets/js/18.475b9e9c.js"><link rel="prefetch" href="/docs/assets/js/19.1f6e3915.js"><link rel="prefetch" href="/docs/assets/js/20.290f5347.js"><link rel="prefetch" href="/docs/assets/js/21.2df47d15.js"><link rel="prefetch" href="/docs/assets/js/22.d2c6cde0.js"><link rel="prefetch" href="/docs/assets/js/23.d9b20639.js"><link rel="prefetch" href="/docs/assets/js/24.071c5575.js"><link rel="prefetch" href="/docs/assets/js/25.16bd1dc7.js"><link rel="prefetch" href="/docs/assets/js/26.195b28e1.js"><link rel="prefetch" href="/docs/assets/js/27.73d48ab6.js"><link rel="prefetch" href="/docs/assets/js/28.31027141.js"><link rel="prefetch" href="/docs/assets/js/29.46669013.js"><link rel="prefetch" href="/docs/assets/js/3.21d58b5a.js"><link rel="prefetch" href="/docs/assets/js/30.51c5e597.js"><link rel="prefetch" href="/docs/assets/js/31.78baab02.js"><link rel="prefetch" href="/docs/assets/js/32.466e3cd8.js"><link rel="prefetch" href="/docs/assets/js/33.103c24d9.js"><link rel="prefetch" href="/docs/assets/js/34.16e16cec.js"><link rel="prefetch" href="/docs/assets/js/35.297d08e3.js"><link rel="prefetch" href="/docs/assets/js/36.f1a8004d.js"><link rel="prefetch" href="/docs/assets/js/37.27a7f22e.js"><link rel="prefetch" href="/docs/assets/js/38.d419b328.js"><link rel="prefetch" href="/docs/assets/js/39.e072de90.js"><link rel="prefetch" href="/docs/assets/js/4.4153d545.js"><link rel="prefetch" href="/docs/assets/js/40.6c2bce7c.js"><link rel="prefetch" href="/docs/assets/js/41.141a7cb3.js"><link rel="prefetch" href="/docs/assets/js/42.08a055ed.js"><link rel="prefetch" href="/docs/assets/js/43.fbb0ffb6.js"><link rel="prefetch" href="/docs/assets/js/44.c4bd1400.js"><link rel="prefetch" href="/docs/assets/js/45.35f85138.js"><link rel="prefetch" href="/docs/assets/js/46.5c7a69cf.js"><link rel="prefetch" href="/docs/assets/js/47.d3189f26.js"><link rel="prefetch" href="/docs/assets/js/48.85fcc229.js"><link rel="prefetch" href="/docs/assets/js/5.bd8e06c0.js"><link rel="prefetch" href="/docs/assets/js/6.8d5527f5.js"><link rel="prefetch" href="/docs/assets/js/7.f6894f62.js"><link rel="prefetch" href="/docs/assets/js/9.acef81fd.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.6b8e1be2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="milk.png" alt="草莓牛奶" class="logo"> <span class="site-name can-hide">草莓牛奶</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/guide/" class="nav-link">
  Markdown语法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><span class="title">学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习" class="mobile-dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/study/javaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/git/base01.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/vue/base01.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/english/base01.html" class="nav-link">
  English
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="路线" class="dropdown-title"><span class="title">路线</span> <span class="arrow down"></span></button> <button type="button" aria-label="路线" class="mobile-dropdown-title"><span class="title">路线</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/route/atguigu/base01.html" class="nav-link">
  尚硅谷
</a></li><li class="dropdown-item"><!----> <a href="/docs/route/coderwhy/base01.html" class="nav-link">
  coderwhy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/advance/scss/base01.html" class="nav-link">
  Sass
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="读书笔记" class="mobile-dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/readingNote/theDefinitiveGuideToHTML5/part1.html" class="nav-link">
  HTML5权威指南
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专栏" class="dropdown-title"><span class="title">专栏</span> <span class="arrow down"></span></button> <button type="button" aria-label="专栏" class="mobile-dropdown-title"><span class="title">专栏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/special-column/browser/base01.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  浏览器工作原理与实践
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zhaodesen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/strawberry_milk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/guide/" class="nav-link">
  Markdown语法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><span class="title">学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习" class="mobile-dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/study/javaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/git/base01.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/vue/base01.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/docs/study/english/base01.html" class="nav-link">
  English
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="路线" class="dropdown-title"><span class="title">路线</span> <span class="arrow down"></span></button> <button type="button" aria-label="路线" class="mobile-dropdown-title"><span class="title">路线</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/route/atguigu/base01.html" class="nav-link">
  尚硅谷
</a></li><li class="dropdown-item"><!----> <a href="/docs/route/coderwhy/base01.html" class="nav-link">
  coderwhy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/advance/scss/base01.html" class="nav-link">
  Sass
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="读书笔记" class="mobile-dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/readingNote/theDefinitiveGuideToHTML5/part1.html" class="nav-link">
  HTML5权威指南
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专栏" class="dropdown-title"><span class="title">专栏</span> <span class="arrow down"></span></button> <button type="button" aria-label="专栏" class="mobile-dropdown-title"><span class="title">专栏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/special-column/browser/base01.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  浏览器工作原理与实践
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zhaodesen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/strawberry_milk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Browser</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/special-column/browser/base01.html" aria-current="page" class="active sidebar-link">Chrome架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/special-column/browser/base01.html#进程和线程" class="sidebar-link">进程和线程</a></li><li class="sidebar-sub-header"><a href="/docs/special-column/browser/base01.html#单进程浏览器时代" class="sidebar-link">单进程浏览器时代</a></li><li class="sidebar-sub-header"><a href="/docs/special-column/browser/base01.html#多进程浏览器时代" class="sidebar-link">多进程浏览器时代</a></li><li class="sidebar-sub-header"><a href="/docs/special-column/browser/base01.html#目前多进程架构" class="sidebar-link">目前多进程架构</a></li><li class="sidebar-sub-header"><a href="/docs/special-column/browser/base01.html#未来面向服务的架构" class="sidebar-link">未来面向服务的架构</a></li></ul></li><li><a href="/docs/special-column/browser/base02.html" class="sidebar-link">TCP协议</a></li><li><a href="/docs/special-column/browser/base03.html" class="sidebar-link">HTTP请求流程</a></li><li><a href="/docs/special-column/browser/base04.html" class="sidebar-link">导航流程</a></li><li><a href="/docs/special-column/browser/base05.html" class="sidebar-link">渲染流程</a></li><li><a href="/docs/special-column/browser/base06.html" class="sidebar-link">变量提升</a></li><li><a href="/docs/special-column/browser/base07.html" class="sidebar-link">调用栈</a></li><li><a href="/docs/special-column/browser/base08.html" class="sidebar-link">块级作用域</a></li><li><a href="/docs/special-column/browser/base09.html" class="sidebar-link">作用域链和闭包</a></li><li><a href="/docs/special-column/browser/base10.html" class="sidebar-link">this</a></li><li><a href="/docs/special-column/browser/base11.html" class="sidebar-link">栈空间和堆空间</a></li><li><a href="/docs/special-column/browser/base12.html" class="sidebar-link">垃圾回收</a></li><li><a href="/docs/special-column/browser/base13.html" class="sidebar-link">编译器和解释器</a></li><li><a href="/docs/special-column/browser/base14.html" class="sidebar-link">消息队列和事件循环</a></li><li><a href="/docs/special-column/browser/base15.html" class="sidebar-link">setTimeout</a></li><li><a href="/docs/special-column/browser/base16.html" class="sidebar-link">XMLHttpRequest</a></li><li><a href="/docs/special-column/browser/base17.html" class="sidebar-link">宏任务和微任务</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="进程和线程"><a href="#进程和线程" class="header-anchor">#</a> 进程和线程</h2> <ul><li><code>并行处理:</code> 同一时刻处理多个任务</li> <li><code>单线程:</code> 按照顺序执行任务,同一时刻处理一个任务</li> <li><code>多线程:</code> 可以并行处理任务</li> <li><code>线程:</code> 是不能单独存在的,由<code>进程</code>启动和管理</li> <li><code>进程:</code> 是一个程序的运行实例,启动一个程序的时候,操作系统会为该程序创建一块内存,用来存放代码,运行中的数据和一个执行任务的主线程,我们把这样的一个运行环境叫<code>进程</code></li></ul> <p><img src="/docs/assets/img/progress.3380f0a1.png" alt="progress"></p> <blockquote><p>线程依附于进程,而进程使用多线程并行处理提升运算效率</p></blockquote> <p>进程和线程之间的关系有<code>4</code>个特点:</p> <ol><li>进程中的任意一线程执行出错,都会导致整个进程崩溃</li> <li>线程之间共享进程中的数据</li></ol> <p><img src="/docs/assets/img/multithreading.d0efacd7.png" alt="progress"></p> <blockquote><p>线程 1,2,3 分别把执行结果写入 A,B,C 中,然后线程 2 继续从 A,B,C 中读取数据,用来显示执行结果</p></blockquote> <ol start="3"><li>当一个进程关闭后,操作系统会回收进程所占用的内存</li> <li>进程之间的内容相互隔离
<blockquote><p>如果进程需要进行数据的通信,可以使用用于进程间通信的<code>IPC</code>机制</p></blockquote></li></ol> <h2 id="单进程浏览器时代"><a href="#单进程浏览器时代" class="header-anchor">#</a> 单进程浏览器时代</h2> <p>单进程浏览器是指浏览器的所有功能模块都运行在同一个进程里,这些模块包含了<code>网络,插件,JavaScript 运行环境,渲染引擎和页面</code>等,早在 <code>2007</code> 年之前, 市面上浏览器都是单进程的
<img src="/docs/assets/img/single-process-browser.6ddad241.png" alt="single-process-browser"></p> <blockquote><p>单进程浏览器架构示意图</p></blockquote> <p>如此多的功能模块运行在一个进程里,是导致单进程浏览器<code>不稳定</code>,<code>不流畅</code>和<code>不安全</code>的一个主要因素</p> <h3 id="问题一-不稳定"><a href="#问题一-不稳定" class="header-anchor">#</a> 问题一: 不稳定</h3> <p>早期浏览器需要借助于插件来实现诸如<code>Web</code>视频、<code>Web</code> 游戏等各种强大的功能，但是插件是最容易出问题的模块，并且还运行在浏览器进程之中，所以一个插件的意外崩溃会引起整个浏览器的崩溃。
除了插件之外，渲染引擎模块也是不稳定的，通常一些复杂的 <code>JavaScript</code> 代码就有可能引起渲染引擎模块的崩溃。和插件一样，渲染引擎的崩溃也会导致整个浏览器的崩溃。</p> <h3 id="问题二-不流畅"><a href="#问题二-不流畅" class="header-anchor">#</a> 问题二: 不流畅</h3> <p>所有页面的渲染模块、<code>JavaScript</code> 执行环境以及插件都是运行在同一个线程中的，这就意味着同一时刻只能有一个模块可以执行,此外,<code>脚本(比如:while(1){...},无线循环),插件,页面内存泄漏</code>也是单进程变慢的重要原因</p> <h3 id="问题三-不安全"><a href="#问题三-不安全" class="header-anchor">#</a> 问题三: 不安全</h3> <ul><li>插件可以使用<code>C/C++</code>等代码编写，通过插件可以获取到操作系统的任意资源。如果是个恶意插件，那么它就可以释放病毒、窃取你的账号密码，引发安全性问题。</li> <li>页面脚本可以通过浏览器的漏洞来获取系统权限，这些脚本获取系统权限之后也可以对你的电脑做一些恶意的事情，同样也会引发安全问题。</li></ul> <h2 id="多进程浏览器时代"><a href="#多进程浏览器时代" class="header-anchor">#</a> 多进程浏览器时代</h2> <p><img src="/docs/assets/img/multithreading-browser.cdc9215e.png" alt="multithreading-browser"></p> <blockquote><p><code>2008</code>年 <code>Chrome</code>发布时的进程架构
<code>Chrome</code>的页面是运行在单独的渲染进程中的,同时页面里的插件也是运行在单独的插件进程之中,而进程之间是通过<code>IPC</code> 机制进行通信的</p></blockquote> <h3 id="解决问题一-不稳定"><a href="#解决问题一-不稳定" class="header-anchor">#</a> 解决问题一: 不稳定</h3> <p>由于进程之间相互隔离,当一个页面或者插件崩溃,影响的仅仅是当前页面进程或插件进程,不会影响到浏览器和其他页面</p> <h3 id="解决问题二-不流畅"><a href="#解决问题二-不流畅" class="header-anchor">#</a> 解决问题二: 不流畅</h3> <ul><li><code>JavaScript</code> 运行在渲染进程中,当它阻塞了渲染进程,影响的也只是当前的渲染页面,不会影响到浏览器和其他页面</li> <li>当关闭一个页面时,整个渲染进程也会被关闭,该进程所占用的内存都会被系统回收,解决了浏览器页面内存泄漏的问题</li></ul> <h3 id="解决问题三-不安全"><a href="#解决问题三-不安全" class="header-anchor">#</a> 解决问题三: 不安全</h3> <p>采用多进程架构的额外好处是可以使用安全沙箱，可以把沙箱看成是操作系统给进程上了一把锁，沙箱里面的程序可以运行，但是不能在你的硬盘上写入任何数据，也不能在敏感位置读取任何数据。<code>Chrome</code>把插件进程和渲染进程锁在沙箱里面，这样即使在渲染进程或者插件进程里面执行了恶意程序，恶意程序也无法突破沙箱去获取系统权限。</p> <h2 id="目前多进程架构"><a href="#目前多进程架构" class="header-anchor">#</a> 目前多进程架构</h2> <p><img src="/docs/assets/img/now-browser.b61cab52.png" alt="now-browser">
最新的 <code>Chrome</code> 浏览器包括:</p> <ul><li><strong>浏览器主进程</strong>: 负责界面显示,用户交互,子进程管理,存储等功能</li> <li><strong>GPU 进程</strong>: <code>Chrome</code> 刚开始发布的时候是没有<code>GPU</code> 进程的。而它初衷是为了实现<code>3D CSS</code> 的效果，只是随后网页、<code>Chrome</code> 的 <code>UI</code> 界面都选择采用<code>GPU</code>来绘制，这使得 <code>GPU</code>成为浏览器普遍的需求。最后，<code>Chrome</code> 在其多进程架构上也引入了 <code>GPU</code> 进程。</li> <li><strong>网络进程</strong>: 负责页面的网络资源加载，之前是作为一个模块运行在浏览器进程里面的，直至最近才独立出来，成为一个单独的进程。</li> <li><strong>多个渲染进程</strong>: 核心任务是将 <code>HTML</code>、<code>CSS</code> 和 <code>JavaScript</code> 转换为用户可以与之交互的网页，排版引擎 <code>Blink</code>和 <code>JavaScript</code> 引擎 <code>V8</code> 都是运行在该进程中，默认情况下，<code>Chrome</code> 会为每个 <code>Tab</code>标签创建一个渲染进程。出于安全考虑，渲染进程都是运行在沙箱模式下。</li> <li><strong>多个插件进程</strong>: 负责插件的运行，因插件易崩溃，所以需要通过插件进程来隔离，以保证插件进程崩溃不会对浏览器和页面造成影响。</li></ul> <p>多进程模型带来的问题:</p> <ul><li><strong>更高的资源占用</strong> : 因为每个进程都会包含公共基础结构的副本（如 JavaScript 运行环境），这就意味着浏览器会消耗更多的内存资源。</li> <li><strong>更复杂的体系结构</strong>: 浏览器各模块之间耦合性高、扩展性差等问题，会导致现在的架构已经很难适应新的需求了。</li></ul> <h2 id="未来面向服务的架构"><a href="#未来面向服务的架构" class="header-anchor">#</a> 未来面向服务的架构</h2> <p>为了解决这些问题，在 <code>2016</code> 年，<code>Chrome</code> 官方团队使用<code>面向服务的架构</code>（<code>Services Oriented Architecture</code>，简称 <code>SOA</code>）的思想设计了新的 Chrome 架构。也就是说 <code>Chrome</code> 整体架构会朝向现代操作系统所采用的“面向服务的架构” 方向发展，原来的各种模块会被重构成独立的服务（<code>Service</code>），每个服务（<code>Service</code>）都可以在独立的进程中运行，访问服务（<code>Service</code>）必须使用定义好的接口，通过 <code>IPC</code> 来通信，从而构建一个更内聚、松耦合、易于维护和扩展的系统，更好实现 <code>Chrome</code> 简单、稳定、高速、安全的目标。</p> <blockquote><p><code>Chrome</code>最终要把 UI、数据库、文件、设备、网络等模块重构为基础服务，类似操作系统底层服务，下面是<code>Chrome 面向服务的架构</code>的进程模型图：</p></blockquote> <p><img src="/docs/assets/img/soa-browser.329658fe.png" alt="soa-browser"></p> <p><code>Chrome</code>正在逐步构建 <code>Chrome</code> 基础服务（<code>Chrome Foundation Service</code>），如果你认为<code>Chrome</code> 是“便携式操作系统”，那么 <code>Chrome</code> 基础服务便可以被视为该操作系统的“基础”系统服务层。</p> <p>同时 <code>Chrome</code> 还提供灵活的弹性架构，在强大性能设备上会以多进程的方式运行基础服务，但是如果在资源受限的设备上（如下图），<code>Chrome</code>会将很多服务整合到一个进程中，从而节省内存占用。</p> <p><img src="/docs/assets/img/limitation-browser.a9ba86d7.png" alt="limitation-browser"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/docs/special-column/browser/base02.html">
        TCP协议
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/docs/assets/js/app.f83263f5.js" defer></script><script src="/docs/assets/js/2.61df76d7.js" defer></script><script src="/docs/assets/js/8.98e910b4.js" defer></script>
  </body>
</html>
